dependencies:
  pre:
    - sudo apt-get purge mongodb-org*
    - sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10
    - echo "deb http://repo.mongodb.org/apt/ubuntu precise/mongodb-org/3.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.0.list
    - sudo apt-get update
    - sudo apt-get install -y mongodb-org
    - sudo service mongod restart
  override:
	- mkdir -p ~/.go_project/src/github.com/${CIRCLE_PROJECT_USERNAME}
	- ln -s ${HOME}/${CIRCLE_PROJECT_REPONAME} ${HOME}/.go_project/src/github.com/${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}
    - go get -u github.com/govend/govend
    - cd ${HOME}/.go_project/src/github.com/supple/gorest && govend

test:
  override:
    - cd ${HOME}/.go_project/src/github.com/supple/gorest && go test -v -race $(go list ./... | grep -v /vendor/)